
running 3 tests
test log_parser::tests::test_count_occurrences ... ok
test log_parser::tests::test_log_parser_contains ... ok
test log_parser::tests::test_log_parser_sequence ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.02s


running 12 tests
test test_forced_stop::test_forced_stop ... 
========================================
TEST: Forced Stop
========================================

=== Test Executor Setup ===
Test: forced-stop
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927347
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927347\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927347\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927347
PROCMAN started with PID: Some(32460)
[PROCMAN] [2m2025-11-23T19:49:07.984145Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:49:07.985853Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927347\config.yaml
[PROCMAN] [2m2025-11-23T19:49:07.994683Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:49:07.994857Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:49:08.958557Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:49:08.958695Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:49:08.961114Z[0m [32m INFO[0m ThreadId(01) Process testexe (PID: 27572) no longer exists, cleaning up
[PROCMAN] [2m2025-11-23T19:49:08.962687Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 0 reattached, 1 cleaned up
[PROCMAN] [2m2025-11-23T19:49:08.962764Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:49:08.962826Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:49:08.962918Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:08.962972Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:08.981475Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:08.981771Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:49:08.982017Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:08.982004Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:08.982071Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:08.982168Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:08.982242Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:08.982211Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 27268, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:08.982335Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:08.982400Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:08.982745Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:08.982877Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:08.984966Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:08.985148Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:08.985270Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:49:08.985330Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:08.998051Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
PROCMAN is ready
Step 1: Waiting for TESTEXE to be running...
Process 'testexe' is running
‚úì TESTEXE is running

Step 2: Letting TESTEXE run for 1 second...
‚úì TESTEXE has been running

Step 3: PROCMAN will force-kill with short timeout...
Sending termination signal to PROCMAN...
[PROCMAN] [2m2025-11-23T19:49:09.016505Z[0m [33m WARN[0m ThreadId(06) Process testexe (PID: 27268) exited with non-zero status: Some(2)
[PROCMAN] [2m2025-11-23T19:49:09.016592Z[0m [32m INFO[0m ThreadId(06) Exit monitor completed for process testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:09.990861Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:09.991026Z[0m [32m INFO[0m ThreadId(09) Process 27268 has exited (Windows: exit_code=2, result=1)
[PROCMAN] [2m2025-11-23T19:49:09.991067Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=false, error=Some("Process 27268 has exited (exit code: 2)")
[PROCMAN] [2m2025-11-23T19:49:09.991150Z[0m [33m WARN[0m ThreadId(09) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Process 27268 has exited (exit code: 2)
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Forced Stop
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927347
ok
test test_graceful_stop::test_graceful_stop ... 
========================================
TEST: Graceful Stop
========================================

=== Test Executor Setup ===
Test: graceful-stop
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927350
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927350\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927350\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927350
PROCMAN started with PID: Some(12508)
[PROCMAN] [2m2025-11-23T19:49:10.541277Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:49:10.541653Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927350\config.yaml
[PROCMAN] [2m2025-11-23T19:49:10.545163Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:49:10.545264Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:49:11.286062Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:49:11.286198Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:49:11.289355Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 27268)
[PROCMAN] [2m2025-11-23T19:49:11.291084Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:49:11.291140Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:49:11.291183Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:49:11.291226Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:11.291276Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:11.307822Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:11.308003Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:49:11.308105Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:11.308133Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:11.308157Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:11.308128Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:11.308198Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:11.308215Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 31808, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:11.308316Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:11.308360Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:11.308535Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:11.308639Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:11.309331Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:11.309386Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:11.309428Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:49:11.309450Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:11.320078Z[0m [33m WARN[0m ThreadId(09) Process testexe (PID: 31808) exited with non-zero status: Some(2)
[PROCMAN] [2m2025-11-23T19:49:11.320093Z[0m [32m INFO[0m ThreadId(05) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:11.320179Z[0m [32m INFO[0m ThreadId(09) Exit monitor completed for process testexe (PID: 31808)
PROCMAN is ready
Step 1: Waiting for TESTEXE to be running...
Process 'testexe' is running
‚úì TESTEXE is running

Step 2: Letting TESTEXE run for 2 seconds...
‚úì TESTEXE has been running

Step 3: PROCMAN will send shutdown signal...
Sending termination signal to PROCMAN...
[PROCMAN] [2m2025-11-23T19:49:12.314052Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:12.314262Z[0m [32m INFO[0m ThreadId(08) Process 31808 has exited (Windows: exit_code=2, result=1)
[PROCMAN] [2m2025-11-23T19:49:12.314300Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=false, error=Some("Process 31808 has exited (exit code: 2)")
[PROCMAN] [2m2025-11-23T19:49:12.314340Z[0m [33m WARN[0m ThreadId(08) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Process 31808 has exited (exit code: 2)
[PROCMAN] [2m2025-11-23T19:49:13.322675Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:13.322710Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:13.322875Z[0m [32m INFO[0m ThreadId(02) Process 31808 has exited (Windows: exit_code=2, result=1)
[PROCMAN] [2m2025-11-23T19:49:13.322950Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=false, error=Some("Process 31808 has exited (exit code: 2)")
[PROCMAN] [2m2025-11-23T19:49:13.323005Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Process 31808 has exited (exit code: 2)
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Graceful Stop
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927350
ok
test test_graceful_stop::test_graceful_stop_detailed ... ignored
test test_health_restart::test_health_restart ... 
========================================
TEST: Health Check Restart
========================================

=== Test Executor Setup ===
Test: health-restart
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927353
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927353\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927353\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927353
PROCMAN started with PID: Some(10740)
[PROCMAN] [2m2025-11-23T19:49:13.912728Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:49:13.913789Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927353\config.yaml
[PROCMAN] [2m2025-11-23T19:49:13.919942Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:49:13.920038Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:49:14.475536Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:49:14.475655Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:49:14.479411Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 31808)
[PROCMAN] [2m2025-11-23T19:49:14.480760Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:49:14.480936Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:49:14.481041Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:49:14.481133Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:14.481210Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
PROCMAN is ready
Step 1: Waiting for TESTEXE first run...
[PROCMAN] [2m2025-11-23T19:49:14.497541Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:14.498034Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:49:14.498254Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:14.498232Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:14.498309Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:14.498346Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:14.498417Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:14.498406Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 11984, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:14.498498Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:14.498552Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:14.499284Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:14.499593Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:14.499854Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:14.499918Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:14.499962Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:49:14.499983Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:14.515812Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
Process 'testexe' is running
‚úì TESTEXE first run started

Step 2: Waiting for TESTEXE to exit after 3 seconds...
[PROCMAN] [2m2025-11-23T19:49:15.508963Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:15.509073Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:16.500079Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:16.500169Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:16.515391Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:17.504151Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:17.504239Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:18.514146Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:18.514146Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:18.514408Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
‚ö† No exit message found in logs
Step 3: Waiting for PROCMAN to restart TESTEXE...
[PROCMAN] [2m2025-11-23T19:49:18.625618Z[0m [32m INFO[0m ThreadId(06) Process testexe (PID: 11984) exited successfully with code: Some(0)
[PROCMAN] [2m2025-11-23T19:49:18.625689Z[0m [32m INFO[0m ThreadId(06) Exit monitor completed for process testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:19.509705Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:19.510278Z[0m [32m INFO[0m ThreadId(09) Process 11984 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:49:19.510330Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=false, error=Some("Process 11984 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:49:19.510399Z[0m [33m WARN[0m ThreadId(09) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Process 11984 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:49:20.503252Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:20.503292Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:20.503492Z[0m [32m INFO[0m ThreadId(02) Process 11984 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:49:20.503532Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=false, error=Some("Process 11984 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:49:20.503582Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Process 11984 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:49:21.507699Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:21.507866Z[0m [32m INFO[0m ThreadId(07) Process 11984 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:49:21.507893Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=false, error=Some("Process 11984 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:49:21.507923Z[0m [33m WARN[0m ThreadId(07) ‚ùå Health check failed for testexe: consecutive failures = 3/3, reason: Process 11984 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:49:21.507958Z[0m [31mERROR[0m ThreadId(07) üö® Health check failure threshold reached for testexe (failures: 3)
[PROCMAN] [2m2025-11-23T19:49:21.507999Z[0m [32m INFO[0m ThreadId(07) üìû Calling restart callback for testexe
[PROCMAN] [2m2025-11-23T19:49:21.508038Z[0m [32m INFO[0m ThreadId(07) üîî Health restart callback invoked for testexe: Process 11984 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:49:21.508067Z[0m [32m INFO[0m ThreadId(07) üîß Restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:49:21.508100Z[0m [32m INFO[0m ThreadId(07) ‚úÖ Health restart allowed, queueing restart request for testexe: Process 11984 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:49:21.508129Z[0m [32m INFO[0m ThreadId(07) üì¨ Restart request queued successfully for testexe
[PROCMAN] [2m2025-11-23T19:49:21.508154Z[0m [32m INFO[0m ThreadId(07) ‚úÖ Restart callback succeeded for testexe
‚úì PROCMAN restarted TESTEXE

Step 4: Verifying second instance is running...
[PROCMAN] [2m2025-11-23T19:49:22.499234Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:22.499265Z[0m [32m INFO[0m ThreadId(09) Restart request(s) pending for testexe - will be processed on next heartbeat
[PROCMAN] [2m2025-11-23T19:49:22.499380Z[0m [32m INFO[0m ThreadId(07) Process 11984 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:49:22.499410Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=false, error=Some("Process 11984 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:49:22.499436Z[0m [33m WARN[0m ThreadId(07) ‚ùå Health check failed for testexe: consecutive failures = 4/3, reason: Process 11984 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:49:22.513945Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:22.514043Z[0m [32m INFO[0m ThreadId(06) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:49:22.514069Z[0m [32m INFO[0m ThreadId(06) üîÑ Processing restart request for testexe: Process 11984 has exited (exit code: 0) (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:49:22.514117Z[0m [32m INFO[0m ThreadId(06) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:49:22.514135Z[0m [32m INFO[0m ThreadId(06) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:49:22.514228Z[0m [32m INFO[0m ThreadId(06) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:49:22.514260Z[0m [32m INFO[0m ThreadId(06) Sending termination signal to PID 11984
[PROCMAN] [2m2025-11-23T19:49:22.772770Z[0m [33m WARN[0m ThreadId(06) taskkill returned non-zero status for PID 11984: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ "11984".
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:49:22.772840Z[0m [32m INFO[0m ThreadId(06) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:49:22.772862Z[0m [32m INFO[0m ThreadId(06) Process control stopped successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:24.780478Z[0m [32m INFO[0m ThreadId(09) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:24.780565Z[0m [32m INFO[0m ThreadId(09) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:24.794665Z[0m [32m INFO[0m ThreadId(09) Process spawned successfully: testexe (PID: 1936)
[PROCMAN] [2m2025-11-23T19:49:24.794745Z[0m [32m INFO[0m ThreadId(09) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:49:24.794818Z[0m [32m INFO[0m ThreadId(09) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:24.794836Z[0m [32m INFO[0m ThreadId(09) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:24.794852Z[0m [32m INFO[0m ThreadId(09) Spawning resource monitor task for testexe (PID: 1936)
[PROCMAN] [2m2025-11-23T19:49:24.794853Z[0m [32m INFO[0m ThreadId(07) Exit monitor started for process testexe (PID: 1936)
[PROCMAN] [2m2025-11-23T19:49:24.794875Z[0m [32m INFO[0m ThreadId(09) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:24.794903Z[0m [32m INFO[0m ThreadId(09) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:24.794911Z[0m [32m INFO[0m ThreadId(07) Health check loop started for testexe (PID: 1936, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:24.794936Z[0m [32m INFO[0m ThreadId(09) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:24.795018Z[0m [32m INFO[0m ThreadId(09) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:49:24.795058Z[0m [32m INFO[0m ThreadId(09) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:24.795095Z[0m [32m INFO[0m ThreadId(09) ‚úÖ Automatic restart succeeded for testexe (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:49:24.795137Z[0m [32m INFO[0m ThreadId(09) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:49:24.795171Z[0m [32m INFO[0m ThreadId(09) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:49:24.795222Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:24.810777Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 1936)
[PROCMAN] [2m2025-11-23T19:49:24.810869Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:25.801038Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 1936)
[PROCMAN] [2m2025-11-23T19:49:25.801120Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:26.523813Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
Process spawn count: 2
‚úì Second instance confirmed (spawn count: 2)

Sending termination signal to PROCMAN...
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Health Check Restart
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927353
ok
test test_health_restart::test_max_restart_attempts ... ignored
test test_http_health::test_http_health_restart ... 
========================================
TEST: HTTP Health Check Restart
========================================

=== Test Executor Setup ===
Test: http-health-restart
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927367
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927367\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927367\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927367
PROCMAN started with PID: Some(6140)
[PROCMAN] [2m2025-11-23T19:49:27.135449Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:49:27.135845Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927367\config.yaml
[PROCMAN] [2m2025-11-23T19:49:27.140364Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:49:27.140451Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:49:27.705951Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:49:27.706096Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:49:27.718212Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 11984)
[PROCMAN] [2m2025-11-23T19:49:27.718532Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:49:27.718592Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:49:27.718631Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:49:27.718674Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:27.718708Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
PROCMAN is ready
Step 1: Waiting for TESTEXE to start with HTTP health server...
[PROCMAN] [2m2025-11-23T19:49:27.740161Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:27.740578Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Http)
[PROCMAN] [2m2025-11-23T19:49:27.740625Z[0m [32m INFO[0m ThreadId(01) HTTP health check endpoint: http://127.0.0.1:18080/
[PROCMAN] [2m2025-11-23T19:49:27.740773Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:27.740816Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:27.740866Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:27.740951Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:27.741021Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:27.741063Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:27.741377Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:27.741433Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 13592, interval: 3s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:27.742748Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:27.742936Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:27.742999Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:49:27.743036Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:27.743208Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:27.751191Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:27.753057Z[0m [33m WARN[0m ThreadId(09) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Unexpected status code: 503 Service Unavailable
Process 'testexe' is running
[PROCMAN] [2m2025-11-23T19:49:29.753912Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
‚ö† No HTTP server startup message found
Step 2: Waiting for initial health checks to pass...
[PROCMAN] [2m2025-11-23T19:49:30.744086Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:30.745452Z[0m [33m WARN[0m ThreadId(06) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:31.752208Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
‚ö† No successful health check logs found
Step 3: Waiting for health checks to start failing (fail-health-after=5s)...
[PROCMAN] [2m2025-11-23T19:49:33.755076Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:33.755405Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:33.757088Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 3/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:33.757165Z[0m [31mERROR[0m ThreadId(02) üö® Health check failure threshold reached for testexe (failures: 3)
[PROCMAN] [2m2025-11-23T19:49:33.757198Z[0m [32m INFO[0m ThreadId(02) üìû Calling restart callback for testexe
[PROCMAN] [2m2025-11-23T19:49:33.757214Z[0m [32m INFO[0m ThreadId(02) üîî Health restart callback invoked for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:33.757232Z[0m [32m INFO[0m ThreadId(02) üîß Restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:49:33.757251Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Health restart allowed, queueing restart request for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:33.757270Z[0m [32m INFO[0m ThreadId(02) üì¨ Restart request queued successfully for testexe
[PROCMAN] [2m2025-11-23T19:49:33.757283Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Restart callback succeeded for testexe
[PROCMAN] [2m2025-11-23T19:49:35.748211Z[0m [32m INFO[0m ThreadId(09) Restart request(s) pending for testexe - will be processed on next heartbeat
[PROCMAN] [2m2025-11-23T19:49:35.748212Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:35.748376Z[0m [32m INFO[0m ThreadId(02) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:49:35.748405Z[0m [32m INFO[0m ThreadId(02) üîÑ Processing restart request for testexe: Unexpected status code: 503 Service Unavailable (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:49:35.748433Z[0m [32m INFO[0m ThreadId(02) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:49:35.748448Z[0m [32m INFO[0m ThreadId(02) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:49:35.748505Z[0m [32m INFO[0m ThreadId(02) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:49:35.748523Z[0m [32m INFO[0m ThreadId(02) Sending termination signal to PID 13592
[PROCMAN] [2m2025-11-23T19:49:35.895853Z[0m [33m WARN[0m ThreadId(02) taskkill returned non-zero status for PID 13592: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ‰®™ÔøΩÔøΩ‡Æ¨ 13592.
[PROCMAN] ÔøΩÔøΩÁ®≠ÔøΩ: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ‡¢†ÔøΩ ‚Æ´Ï™Æ ÔøΩÔøΩ·®´ÔøΩÔøΩ‚¢•ÔøΩÔøΩÔøΩ ( ÔøΩ  ÔøΩÔøΩ‡†¨ÔøΩÔøΩ‡Æ¨ /f ).
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:49:35.895914Z[0m [32m INFO[0m ThreadId(02) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:49:35.895931Z[0m [32m INFO[0m ThreadId(02) Process control stopped successfully: testexe
‚úì Health checks started failing as expected

Step 4: Waiting for restart trigger (after 3 consecutive failures)...
[PROCMAN] [2m2025-11-23T19:49:37.898116Z[0m [32m INFO[0m ThreadId(09) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:37.898285Z[0m [32m INFO[0m ThreadId(09) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:37.911544Z[0m [32m INFO[0m ThreadId(09) Process spawned successfully: testexe (PID: 20256)
[PROCMAN] [2m2025-11-23T19:49:37.911620Z[0m [32m INFO[0m ThreadId(09) Starting health monitor for testexe (type: Http)
[PROCMAN] [2m2025-11-23T19:49:37.911633Z[0m [32m INFO[0m ThreadId(09) HTTP health check endpoint: http://127.0.0.1:18080/
[PROCMAN] [2m2025-11-23T19:49:37.911670Z[0m [32m INFO[0m ThreadId(09) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:37.911682Z[0m [32m INFO[0m ThreadId(09) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:37.911693Z[0m [32m INFO[0m ThreadId(09) Spawning resource monitor task for testexe (PID: 20256)
[PROCMAN] [2m2025-11-23T19:49:37.911708Z[0m [32m INFO[0m ThreadId(09) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:37.911725Z[0m [32m INFO[0m ThreadId(09) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:37.911739Z[0m [32m INFO[0m ThreadId(09) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:37.911749Z[0m [32m INFO[0m ThreadId(08) Exit monitor started for process testexe (PID: 20256)
[PROCMAN] [2m2025-11-23T19:49:37.911766Z[0m [32m INFO[0m ThreadId(09) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:49:37.911863Z[0m [32m INFO[0m ThreadId(06) Health check loop started for testexe (PID: 20256, interval: 3s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:37.911919Z[0m [32m INFO[0m ThreadId(09) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:37.911982Z[0m [32m INFO[0m ThreadId(09) ‚úÖ Automatic restart succeeded for testexe (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:49:37.912025Z[0m [32m INFO[0m ThreadId(09) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:49:37.912059Z[0m [32m INFO[0m ThreadId(09) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:49:37.912114Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:37.913661Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 20256)
[PROCMAN] [2m2025-11-23T19:49:37.915141Z[0m [33m WARN[0m ThreadId(08) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:39.750165Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:40.913369Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 20256)
[PROCMAN] [2m2025-11-23T19:49:40.914730Z[0m [33m WARN[0m ThreadId(08) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:41.755930Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:43.745053Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:43.916045Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 20256)
[PROCMAN] [2m2025-11-23T19:49:43.917613Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 3/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:43.917773Z[0m [31mERROR[0m ThreadId(02) üö® Health check failure threshold reached for testexe (failures: 3)
[PROCMAN] [2m2025-11-23T19:49:43.917791Z[0m [32m INFO[0m ThreadId(02) üìû Calling restart callback for testexe
[PROCMAN] [2m2025-11-23T19:49:43.917811Z[0m [32m INFO[0m ThreadId(02) üîî Health restart callback invoked for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:43.917848Z[0m [32m INFO[0m ThreadId(02) üîß Restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:49:43.917884Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Health restart allowed, queueing restart request for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:43.917928Z[0m [32m INFO[0m ThreadId(02) üì¨ Restart request queued successfully for testexe
[PROCMAN] [2m2025-11-23T19:49:43.917950Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Restart callback succeeded for testexe
‚úì Restart triggered after health failure threshold

Step 5: Verifying second instance is running with passing health checks...
[PROCMAN] [2m2025-11-23T19:49:45.758998Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:45.759102Z[0m [32m INFO[0m ThreadId(02) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:49:45.759237Z[0m [32m INFO[0m ThreadId(02) üîÑ Processing restart request for testexe: Unexpected status code: 503 Service Unavailable (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:49:45.759458Z[0m [32m INFO[0m ThreadId(02) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:49:45.759576Z[0m [32m INFO[0m ThreadId(02) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:49:45.759856Z[0m [32m INFO[0m ThreadId(02) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:49:45.759904Z[0m [32m INFO[0m ThreadId(02) Sending termination signal to PID 20256
[PROCMAN] [2m2025-11-23T19:49:46.040997Z[0m [33m WARN[0m ThreadId(02) taskkill returned non-zero status for PID 20256: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ‰®™ÔøΩÔøΩ‡Æ¨ 20256.
[PROCMAN] ÔøΩÔøΩÁ®≠ÔøΩ: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ‡¢†ÔøΩ ‚Æ´Ï™Æ ÔøΩÔøΩ·®´ÔøΩÔøΩ‚¢•ÔøΩÔøΩÔøΩ ( ÔøΩ  ÔøΩÔøΩ‡†¨ÔøΩÔøΩ‡Æ¨ /f ).
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:49:46.041129Z[0m [32m INFO[0m ThreadId(02) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:49:46.041176Z[0m [32m INFO[0m ThreadId(02) Process control stopped successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:48.043784Z[0m [32m INFO[0m ThreadId(08) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:48.043899Z[0m [32m INFO[0m ThreadId(08) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:48.056430Z[0m [32m INFO[0m ThreadId(08) Process spawned successfully: testexe (PID: 32656)
[PROCMAN] [2m2025-11-23T19:49:48.056515Z[0m [32m INFO[0m ThreadId(08) Starting health monitor for testexe (type: Http)
[PROCMAN] [2m2025-11-23T19:49:48.056533Z[0m [32m INFO[0m ThreadId(08) HTTP health check endpoint: http://127.0.0.1:18080/
[PROCMAN] [2m2025-11-23T19:49:48.056578Z[0m [32m INFO[0m ThreadId(08) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:48.056595Z[0m [32m INFO[0m ThreadId(08) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:48.056610Z[0m [32m INFO[0m ThreadId(08) Spawning resource monitor task for testexe (PID: 32656)
[PROCMAN] [2m2025-11-23T19:49:48.056630Z[0m [32m INFO[0m ThreadId(08) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:48.056653Z[0m [32m INFO[0m ThreadId(08) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:48.056672Z[0m [32m INFO[0m ThreadId(08) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:48.056664Z[0m [32m INFO[0m ThreadId(06) Exit monitor started for process testexe (PID: 32656)
[PROCMAN] [2m2025-11-23T19:49:48.056693Z[0m [32m INFO[0m ThreadId(08) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:49:48.056764Z[0m [32m INFO[0m ThreadId(06) Health check loop started for testexe (PID: 32656, interval: 3s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:48.056771Z[0m [32m INFO[0m ThreadId(08) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:48.056817Z[0m [32m INFO[0m ThreadId(08) ‚úÖ Automatic restart succeeded for testexe (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:49:48.056851Z[0m [32m INFO[0m ThreadId(08) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:49:48.056878Z[0m [32m INFO[0m ThreadId(08) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:49:48.056930Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:48.059240Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 32656)
[PROCMAN] [2m2025-11-23T19:49:48.061266Z[0m [33m WARN[0m ThreadId(06) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:49:49.752954Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
Process spawn count: 3
‚úì Second instance confirmed (spawn count: 3)

‚ö† No recent successful health checks for new instance
Sending termination signal to PROCMAN...
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: HTTP Health Check Restart
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927367
ok
test test_http_health::test_http_health_timeout ... ignored
test test_log_collection::test_log_collection ... 
========================================
TEST: Log Collection
========================================

=== Test Executor Setup ===
Test: log-collection
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927390
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927390\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927390\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927390
PROCMAN started with PID: Some(24640)
[PROCMAN] [2m2025-11-23T19:49:50.378953Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:49:50.379490Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927390\config.yaml
[PROCMAN] [2m2025-11-23T19:49:50.384709Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:49:50.384900Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:49:51.659980Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:49:51.660465Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:49:51.695298Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 13592)
[PROCMAN] [2m2025-11-23T19:49:51.697996Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:49:51.698153Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:49:51.698287Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:49:51.698410Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:51.698574Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:51.791848Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:51.792212Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:49:51.792383Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:51.792535Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:51.792656Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:51.792749Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:51.792722Z[0m [32m INFO[0m ThreadId(07) Health check loop started for testexe (PID: 24528, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:51.792835Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:51.792947Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:51.793014Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:51.793657Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:51.793814Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:51.794651Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:51.794769Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:51.794868Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:49:51.794921Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
PROCMAN is ready
Step 1: Waiting for TESTEXE to start...
Process 'testexe' is running
‚úì TESTEXE started

Step 2: Waiting for process to produce logs...
[PROCMAN] [2m2025-11-23T19:49:51.796516Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:52.803946Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:52.804094Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:53.795950Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:53.796021Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:53.796107Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
‚úì TESTEXE producing output

Step 3: Checking for log files...
‚Ñπ Log directory not created: target/tmp/e2e-test-log-collection\logs
  (This is expected as log collection integration is pending)

Step 4: Graceful shutdown...
Sending termination signal to PROCMAN...
[PROCMAN] [2m2025-11-23T19:49:54.803795Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:54.803887Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:55.800836Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:55.800885Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:49:55.800979Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Log Collection
========================================

Note: Full log collection integration pending.
This test validates the framework is ready.
Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927390
ok
test test_log_collection::test_log_rotation ... ignored
test test_memory_limit::test_cpu_limit_warning ... ignored
test test_memory_limit::test_memory_growth_violation ... ignored
test test_memory_limit::test_memory_limit_violation ... 
========================================
TEST: Memory Limit Violation
========================================

=== Test Executor Setup ===
Test: memory-limit
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927397
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927397\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927397\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927397
PROCMAN started with PID: Some(20052)
[PROCMAN] [2m2025-11-23T19:49:57.391364Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:49:57.391907Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927397\config.yaml
[PROCMAN] [2m2025-11-23T19:49:57.399428Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:49:57.399881Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:49:58.194608Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:49:58.194769Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:49:58.197443Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 24528)
[PROCMAN] [2m2025-11-23T19:49:58.198362Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:49:58.198418Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:49:58.198462Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:49:58.198510Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:49:58.198577Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:49:58.217645Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:49:58.218021Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:49:58.218147Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:49:58.218187Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:58.218164Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:49:58.218227Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:49:58.218365Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:49:58.218339Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 29324, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:49:58.218545Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:49:58.218623Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:58.219641Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:49:58.219786Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:58.219944Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:49:58.219996Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:49:58.219991Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:49:58.220173Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:49:58.220342Z[0m [32m INFO[0m ThreadId(06) üíæ Memory limit configured for testexe: 100 MB (policy: Restart)
[PROCMAN] [2m2025-11-23T19:49:58.234668Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
PROCMAN is ready
Step 1: Waiting for TESTEXE to start...
Process 'testexe' is running
‚úì TESTEXE started

Step 2: Waiting for memory allocation (150MB)...
[PROCMAN] [2m2025-11-23T19:49:59.227989Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:49:59.228108Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:00.224343Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:00.224349Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:00.224504Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:01.225937Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:01.226159Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
‚úì Memory allocation logged

Step 3: Checking for resource monitoring...
[PROCMAN] [2m2025-11-23T19:50:02.221288Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:02.221362Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:02.221490Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:03.230409Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:03.230556Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:04.223205Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:04.223205Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:04.223355Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
‚úì Resource monitoring is active

Step 4: Checking for memory violation detection...
[PROCMAN] [2m2025-11-23T19:50:05.220826Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:05.220929Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:06.230353Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:06.230353Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:06.230789Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:07.225952Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:07.226082Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
‚úì Memory violation detected in logs

Step 5: Waiting for heartbeat to process violation...
[PROCMAN] [2m2025-11-23T19:50:08.220971Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:08.221137Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:08.221158Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:08.221152Z[0m [32m INFO[0m ThreadId(08) üíæ Memory limit configured for testexe: 100 MB (policy: Restart)
[PROCMAN] [2m2025-11-23T19:50:08.221402Z[0m [33m WARN[0m ThreadId(08) ‚ö†Ô∏è  Detected 1 resource violation(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:08.221441Z[0m [32m INFO[0m ThreadId(08) üì§ Sending violation to handler: Memory ‚Üí policy=Restart
[PROCMAN] [2m2025-11-23T19:50:08.221516Z[0m [33m WARN[0m ThreadId(08) üö® Resource violation detected for process testexe: Memory usage 157 MB exceeds limit 100 MB (policy: Restart)
[PROCMAN] [2m2025-11-23T19:50:08.221589Z[0m [31mERROR[0m ThreadId(08) üîÑ RESTART: Resource limit exceeded, triggering automatic restart (policy: restart): Memory usage 157 MB exceeds limit 100 MB
[PROCMAN] [2m2025-11-23T19:50:08.221666Z[0m [32m INFO[0m ThreadId(08) üîß Resource violation restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:50:08.221750Z[0m [32m INFO[0m ThreadId(08) ‚úÖ Resource violation restart allowed, queueing restart request for testexe
[PROCMAN] [2m2025-11-23T19:50:08.221811Z[0m [32m INFO[0m ThreadId(08) üì¨ Resource violation restart request queued for testexe
[PROCMAN] [2m2025-11-23T19:50:09.234045Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:09.234141Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:10.235588Z[0m [32m INFO[0m ThreadId(07) Restart request(s) pending for testexe - will be processed on next heartbeat
[PROCMAN] [2m2025-11-23T19:50:10.235601Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:10.235561Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:10.235779Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:10.235904Z[0m [32m INFO[0m ThreadId(06) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:50:10.235947Z[0m [32m INFO[0m ThreadId(06) üîÑ Processing restart request for testexe: Resource violation: Memory usage 157 MB exceeds limit 100 MB (trigger: ResourceViolation)
[PROCMAN] [2m2025-11-23T19:50:10.235993Z[0m [32m INFO[0m ThreadId(06) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:50:10.236023Z[0m [32m INFO[0m ThreadId(06) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:50:10.236140Z[0m [32m INFO[0m ThreadId(06) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:50:10.236178Z[0m [32m INFO[0m ThreadId(06) Sending termination signal to PID 29324
‚úì Restart request queued

Step 6: Waiting for automatic restart to complete...
[PROCMAN] [2m2025-11-23T19:50:10.470227Z[0m [33m WARN[0m ThreadId(06) taskkill returned non-zero status for PID 29324: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ‰®™ÔøΩÔøΩ‡Æ¨ 29324.
[PROCMAN] ÔøΩÔøΩÁ®≠ÔøΩ: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ‡¢†ÔøΩ ‚Æ´Ï™Æ ÔøΩÔøΩ·®´ÔøΩÔøΩ‚¢•ÔøΩÔøΩÔøΩ ( ÔøΩ  ÔøΩÔøΩ‡†¨ÔøΩÔøΩ‡Æ¨ /f ).
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:50:10.470428Z[0m [32m INFO[0m ThreadId(06) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:50:10.470498Z[0m [32m INFO[0m ThreadId(06) Process control stopped successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:12.472279Z[0m [32m INFO[0m ThreadId(09) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:12.472388Z[0m [32m INFO[0m ThreadId(09) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:12.491176Z[0m [32m INFO[0m ThreadId(09) Process spawned successfully: testexe (PID: 6680)
[PROCMAN] [2m2025-11-23T19:50:12.491268Z[0m [32m INFO[0m ThreadId(09) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:50:12.491349Z[0m [32m INFO[0m ThreadId(09) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:12.491367Z[0m [32m INFO[0m ThreadId(09) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:12.491384Z[0m [32m INFO[0m ThreadId(09) Spawning resource monitor task for testexe (PID: 6680)
[PROCMAN] [2m2025-11-23T19:50:12.491415Z[0m [32m INFO[0m ThreadId(09) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:12.491417Z[0m [32m INFO[0m ThreadId(07) Exit monitor started for process testexe (PID: 6680)
[PROCMAN] [2m2025-11-23T19:50:12.491457Z[0m [32m INFO[0m ThreadId(09) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:12.491510Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 6680, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:12.491524Z[0m [32m INFO[0m ThreadId(09) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:12.491597Z[0m [32m INFO[0m ThreadId(09) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:50:12.491624Z[0m [32m INFO[0m ThreadId(09) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:12.491643Z[0m [32m INFO[0m ThreadId(09) ‚úÖ Automatic restart succeeded for testexe (trigger: ResourceViolation)
[PROCMAN] [2m2025-11-23T19:50:12.491667Z[0m [32m INFO[0m ThreadId(09) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:12.491684Z[0m [32m INFO[0m ThreadId(09) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:12.491731Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:12.503084Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 6680)
[PROCMAN] [2m2025-11-23T19:50:12.503242Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:12.503444Z[0m [32m INFO[0m ThreadId(09) üíæ Memory limit configured for testexe: 100 MB (policy: Restart)
Process spawn count: 2
‚úì Process restarted after memory violation


üìä Test Summary:
  - Process started: ‚úì
  - Memory allocated: ‚úì
  - Resource monitoring: ‚úì
  - Violation detected: ‚úì
  - Restart queued: ‚úì
  - Process restarted: ‚úì
Sending termination signal to PROCMAN...
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST COMPLETED: Memory Limit Violation
(Check summary above for feature status)
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927397
ok

test result: ok. 6 passed; 0 failed; 6 ignored; 0 measured; 0 filtered out; finished in 66.36s


running 1 test
test test_forced_stop ... 
========================================
TEST: Forced Stop
========================================

=== Test Executor Setup ===
Test: forced-stop
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927413
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927413\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927413\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927413
PROCMAN started with PID: Some(7176)
[PROCMAN] [2m2025-11-23T19:50:14.046424Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:50:14.047688Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927413\config.yaml
[PROCMAN] [2m2025-11-23T19:50:14.053586Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:50:14.053718Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:50:14.756191Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:50:14.756315Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:50:14.760513Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 29324)
[PROCMAN] [2m2025-11-23T19:50:14.763279Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:50:14.763379Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:50:14.763428Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:50:14.763476Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:14.763522Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:14.782843Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 27264)
[PROCMAN] [2m2025-11-23T19:50:14.783016Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:50:14.783135Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:14.783180Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:14.783166Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 27264)
[PROCMAN] [2m2025-11-23T19:50:14.783216Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 27264)
[PROCMAN] [2m2025-11-23T19:50:14.783290Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 27264, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:14.783474Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:14.783692Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:14.783792Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:14.784589Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:14.784654Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:14.784703Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:50:14.784726Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:14.797172Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:14.797257Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 27264)
[PROCMAN] [2m2025-11-23T19:50:14.797396Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:14.800241Z[0m [33m WARN[0m ThreadId(07) Process testexe (PID: 27264) exited with non-zero status: Some(2)
[PROCMAN] [2m2025-11-23T19:50:14.800306Z[0m [32m INFO[0m ThreadId(07) Exit monitor completed for process testexe (PID: 27264)
PROCMAN is ready
Step 1: Waiting for TESTEXE to be running...
Process 'testexe' is running
‚úì TESTEXE is running

Step 2: Letting TESTEXE run for 1 second...
‚úì TESTEXE has been running

Step 3: PROCMAN will force-kill with short timeout...
Sending termination signal to PROCMAN...
[PROCMAN] [2m2025-11-23T19:50:15.788154Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 27264)
[PROCMAN] [2m2025-11-23T19:50:15.788487Z[0m [32m INFO[0m ThreadId(02) Process 27264 has exited (Windows: exit_code=2, result=1)
[PROCMAN] [2m2025-11-23T19:50:15.788548Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=false, error=Some("Process 27264 has exited (exit code: 2)")
[PROCMAN] [2m2025-11-23T19:50:15.788642Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Process 27264 has exited (exit code: 2)
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Forced Stop
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-forced-stop\run-1763927413
ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 2.34s


running 2 tests
test test_graceful_stop ... 
========================================
TEST: Graceful Stop
========================================

=== Test Executor Setup ===
Test: graceful-stop
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927416
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927416\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927416\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927416
PROCMAN started with PID: Some(15184)
[PROCMAN] [2m2025-11-23T19:50:16.525473Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:50:16.525850Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927416\config.yaml
[PROCMAN] [2m2025-11-23T19:50:16.528626Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:50:16.528708Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:50:16.946929Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:50:16.947141Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:50:16.949083Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 27264)
[PROCMAN] [2m2025-11-23T19:50:16.950853Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:50:16.950900Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:50:16.950934Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:50:16.950968Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:16.950996Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:16.967405Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:16.967552Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:50:16.967639Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:16.967666Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:16.967654Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:16.967695Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:16.967725Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 6936, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:16.967768Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:16.967829Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:16.967879Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:16.968693Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:16.968763Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:16.968815Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:50:16.968838Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:16.969780Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:16.969822Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:16.969874Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:16.981259Z[0m [33m WARN[0m ThreadId(06) Process testexe (PID: 6936) exited with non-zero status: Some(2)
[PROCMAN] [2m2025-11-23T19:50:16.981347Z[0m [32m INFO[0m ThreadId(06) Exit monitor completed for process testexe (PID: 6936)
PROCMAN is ready
Step 1: Waiting for TESTEXE to be running...
Process 'testexe' is running
‚úì TESTEXE is running

Step 2: Letting TESTEXE run for 2 seconds...
‚úì TESTEXE has been running

Step 3: PROCMAN will send shutdown signal...
Sending termination signal to PROCMAN...
[PROCMAN] [2m2025-11-23T19:50:17.981859Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:17.982043Z[0m [32m INFO[0m ThreadId(08) Process 6936 has exited (Windows: exit_code=2, result=1)
[PROCMAN] [2m2025-11-23T19:50:17.982100Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=false, error=Some("Process 6936 has exited (exit code: 2)")
[PROCMAN] [2m2025-11-23T19:50:17.982141Z[0m [33m WARN[0m ThreadId(08) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Process 6936 has exited (exit code: 2)
[PROCMAN] [2m2025-11-23T19:50:18.976296Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:18.976336Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:18.976590Z[0m [32m INFO[0m ThreadId(02) Process 6936 has exited (Windows: exit_code=2, result=1)
[PROCMAN] [2m2025-11-23T19:50:18.976617Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=false, error=Some("Process 6936 has exited (exit code: 2)")
[PROCMAN] [2m2025-11-23T19:50:18.976645Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Process 6936 has exited (exit code: 2)
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Graceful Stop
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-graceful-stop\run-1763927416
ok
test test_graceful_stop_detailed ... ignored

test result: ok. 1 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out; finished in 3.02s


running 2 tests
test test_health_restart ... 
========================================
TEST: Health Check Restart
========================================

=== Test Executor Setup ===
Test: health-restart
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927419
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927419\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927419\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927419
PROCMAN started with PID: Some(7900)
[PROCMAN] [2m2025-11-23T19:50:19.898649Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:50:19.899105Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927419\config.yaml
[PROCMAN] [2m2025-11-23T19:50:19.903416Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:50:19.903534Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:50:20.499450Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:50:20.499560Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:50:20.502362Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 6936)
[PROCMAN] [2m2025-11-23T19:50:20.503411Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:50:20.503463Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:50:20.503501Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:50:20.503540Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:20.503573Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:20.522345Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:20.522572Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:50:20.522669Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:20.522689Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:20.522790Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:20.522843Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:20.522818Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 18152, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:20.522898Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:20.522982Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:20.523016Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:20.524114Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:20.524369Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:20.524377Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:20.524428Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:20.524482Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:50:20.524511Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:20.529843Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
PROCMAN is ready
Step 1: Waiting for TESTEXE first run...
Process 'testexe' is running
‚úì TESTEXE first run started

Step 2: Waiting for TESTEXE to exit after 3 seconds...
[PROCMAN] [2m2025-11-23T19:50:21.523844Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:21.523958Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:22.529988Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:22.529988Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:22.530131Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:23.538541Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:23.538738Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:24.528732Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:24.528747Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:24.528905Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
‚ö† No exit message found in logs
Step 3: Waiting for PROCMAN to restart TESTEXE...
[PROCMAN] [2m2025-11-23T19:50:24.671682Z[0m [32m INFO[0m ThreadId(02) Process testexe (PID: 18152) exited successfully with code: Some(0)
[PROCMAN] [2m2025-11-23T19:50:24.671771Z[0m [32m INFO[0m ThreadId(02) Exit monitor completed for process testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:25.526383Z[0m [32m INFO[0m ThreadId(07) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:25.526566Z[0m [32m INFO[0m ThreadId(07) Process 18152 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:50:25.526598Z[0m [32m INFO[0m ThreadId(07) üíì Process health check result for testexe: healthy=false, error=Some("Process 18152 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:50:25.526639Z[0m [33m WARN[0m ThreadId(07) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Process 18152 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:50:26.535259Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:26.535248Z[0m [32m INFO[0m ThreadId(07) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:26.535416Z[0m [32m INFO[0m ThreadId(09) Process 18152 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:50:26.535478Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=false, error=Some("Process 18152 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:50:26.535520Z[0m [33m WARN[0m ThreadId(09) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Process 18152 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:50:27.529720Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:27.529872Z[0m [32m INFO[0m ThreadId(08) Process 18152 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:50:27.529896Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=false, error=Some("Process 18152 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:50:27.529919Z[0m [33m WARN[0m ThreadId(08) ‚ùå Health check failed for testexe: consecutive failures = 3/3, reason: Process 18152 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:50:27.529944Z[0m [31mERROR[0m ThreadId(08) üö® Health check failure threshold reached for testexe (failures: 3)
[PROCMAN] [2m2025-11-23T19:50:27.529967Z[0m [32m INFO[0m ThreadId(08) üìû Calling restart callback for testexe
[PROCMAN] [2m2025-11-23T19:50:27.529993Z[0m [32m INFO[0m ThreadId(08) üîî Health restart callback invoked for testexe: Process 18152 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:50:27.530011Z[0m [32m INFO[0m ThreadId(08) üîß Restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:50:27.530031Z[0m [32m INFO[0m ThreadId(08) ‚úÖ Health restart allowed, queueing restart request for testexe: Process 18152 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:50:27.530049Z[0m [32m INFO[0m ThreadId(08) üì¨ Restart request queued successfully for testexe
[PROCMAN] [2m2025-11-23T19:50:27.530063Z[0m [32m INFO[0m ThreadId(08) ‚úÖ Restart callback succeeded for testexe
‚úì PROCMAN restarted TESTEXE

Step 4: Verifying second instance is running...
[PROCMAN] [2m2025-11-23T19:50:28.559661Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:28.559661Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:28.559661Z[0m [32m INFO[0m ThreadId(07) Restart request(s) pending for testexe - will be processed on next heartbeat
[PROCMAN] [2m2025-11-23T19:50:28.559914Z[0m [32m INFO[0m ThreadId(08) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:50:28.560054Z[0m [32m INFO[0m ThreadId(08) üîÑ Processing restart request for testexe: Process 18152 has exited (exit code: 0) (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:50:28.560170Z[0m [32m INFO[0m ThreadId(02) Process 18152 has exited (Windows: exit_code=0, result=1)
[PROCMAN] [2m2025-11-23T19:50:28.560344Z[0m [32m INFO[0m ThreadId(08) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:50:28.560342Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=false, error=Some("Process 18152 has exited (exit code: 0)")
[PROCMAN] [2m2025-11-23T19:50:28.560386Z[0m [32m INFO[0m ThreadId(08) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:50:28.560403Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 4/3, reason: Process 18152 has exited (exit code: 0)
[PROCMAN] [2m2025-11-23T19:50:28.560592Z[0m [32m INFO[0m ThreadId(08) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:50:28.560631Z[0m [32m INFO[0m ThreadId(08) Sending termination signal to PID 18152
[PROCMAN] [2m2025-11-23T19:50:28.907288Z[0m [33m WARN[0m ThreadId(08) taskkill returned non-zero status for PID 18152: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ "18152".
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:50:28.907542Z[0m [32m INFO[0m ThreadId(08) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:50:28.907597Z[0m [32m INFO[0m ThreadId(08) Process control stopped successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:30.911281Z[0m [32m INFO[0m ThreadId(09) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:30.911380Z[0m [32m INFO[0m ThreadId(09) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:30.924948Z[0m [32m INFO[0m ThreadId(09) Process spawned successfully: testexe (PID: 31768)
[PROCMAN] [2m2025-11-23T19:50:30.925034Z[0m [32m INFO[0m ThreadId(09) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:50:30.925103Z[0m [32m INFO[0m ThreadId(09) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:30.925117Z[0m [32m INFO[0m ThreadId(09) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:30.925131Z[0m [32m INFO[0m ThreadId(09) Spawning resource monitor task for testexe (PID: 31768)
[PROCMAN] [2m2025-11-23T19:50:30.925154Z[0m [32m INFO[0m ThreadId(09) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:30.925182Z[0m [32m INFO[0m ThreadId(09) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:30.925206Z[0m [32m INFO[0m ThreadId(09) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:30.925199Z[0m [32m INFO[0m ThreadId(08) Exit monitor started for process testexe (PID: 31768)
[PROCMAN] [2m2025-11-23T19:50:30.925233Z[0m [32m INFO[0m ThreadId(09) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:50:30.925264Z[0m [32m INFO[0m ThreadId(09) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:30.925273Z[0m [32m INFO[0m ThreadId(07) Health check loop started for testexe (PID: 31768, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:30.925288Z[0m [32m INFO[0m ThreadId(09) ‚úÖ Automatic restart succeeded for testexe (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:50:30.925357Z[0m [32m INFO[0m ThreadId(09) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:30.925377Z[0m [32m INFO[0m ThreadId(09) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:30.925408Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:30.927120Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 31768)
[PROCMAN] [2m2025-11-23T19:50:30.927275Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:31.935210Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 31768)
[PROCMAN] [2m2025-11-23T19:50:31.935530Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:32.528455Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
Process spawn count: 2
‚úì Second instance confirmed (spawn count: 2)

Sending termination signal to PROCMAN...
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Health Check Restart
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-health-restart\run-1763927419
ok
test test_max_restart_attempts ... ignored

test result: ok. 1 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out; finished in 13.42s


running 2 tests
test test_http_health_restart ... 
========================================
TEST: HTTP Health Check Restart
========================================

=== Test Executor Setup ===
Test: http-health-restart
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927433
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927433\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927433\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927433
PROCMAN started with PID: Some(29256)
[PROCMAN] [2m2025-11-23T19:50:33.281764Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:50:33.282165Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927433\config.yaml
[PROCMAN] [2m2025-11-23T19:50:33.285972Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:50:33.286362Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:50:33.922826Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:50:33.922943Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:50:33.924901Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 18152)
[PROCMAN] [2m2025-11-23T19:50:33.925794Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:50:33.925852Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:50:33.925904Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:50:33.925964Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:33.926012Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:33.943233Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:33.943401Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Http)
[PROCMAN] [2m2025-11-23T19:50:33.943429Z[0m [32m INFO[0m ThreadId(01) HTTP health check endpoint: http://127.0.0.1:18080/
[PROCMAN] [2m2025-11-23T19:50:33.943501Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:33.943525Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:33.943550Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:33.943589Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:33.943646Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:33.943646Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:33.943687Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:33.943673Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 4836, interval: 3s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:33.944497Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:33.944552Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:33.944598Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:50:33.944619Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:33.951577Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:33.951795Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:33.959287Z[0m [33m WARN[0m ThreadId(06) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Unexpected status code: 503 Service Unavailable
PROCMAN is ready
Step 1: Waiting for TESTEXE to start with HTTP health server...
Process 'testexe' is running
[PROCMAN] [2m2025-11-23T19:50:35.956731Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
‚ö† No HTTP server startup message found
Step 2: Waiting for initial health checks to pass...
[PROCMAN] [2m2025-11-23T19:50:36.948202Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:36.950468Z[0m [33m WARN[0m ThreadId(06) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:37.958606Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
‚ö† No successful health check logs found
Step 3: Waiting for health checks to start failing (fail-health-after=5s)...
[PROCMAN] [2m2025-11-23T19:50:39.946480Z[0m [32m INFO[0m ThreadId(05) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:39.946477Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:39.948367Z[0m [33m WARN[0m ThreadId(02) ‚ùå Health check failed for testexe: consecutive failures = 3/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:39.948471Z[0m [31mERROR[0m ThreadId(02) üö® Health check failure threshold reached for testexe (failures: 3)
[PROCMAN] [2m2025-11-23T19:50:39.948509Z[0m [32m INFO[0m ThreadId(02) üìû Calling restart callback for testexe
[PROCMAN] [2m2025-11-23T19:50:39.948542Z[0m [32m INFO[0m ThreadId(02) üîî Health restart callback invoked for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:39.948577Z[0m [32m INFO[0m ThreadId(02) üîß Restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:50:39.948619Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Health restart allowed, queueing restart request for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:39.948666Z[0m [32m INFO[0m ThreadId(02) üì¨ Restart request queued successfully for testexe
[PROCMAN] [2m2025-11-23T19:50:39.948698Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Restart callback succeeded for testexe
[PROCMAN] [2m2025-11-23T19:50:41.949054Z[0m [32m INFO[0m ThreadId(05) Restart request(s) pending for testexe - will be processed on next heartbeat
[PROCMAN] [2m2025-11-23T19:50:41.949258Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:41.949359Z[0m [32m INFO[0m ThreadId(02) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:50:41.949399Z[0m [32m INFO[0m ThreadId(02) üîÑ Processing restart request for testexe: Unexpected status code: 503 Service Unavailable (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:50:41.949462Z[0m [32m INFO[0m ThreadId(02) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:50:41.949506Z[0m [32m INFO[0m ThreadId(02) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:50:41.949632Z[0m [32m INFO[0m ThreadId(02) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:50:41.949679Z[0m [32m INFO[0m ThreadId(02) Sending termination signal to PID 4836
[PROCMAN] [2m2025-11-23T19:50:42.182557Z[0m [33m WARN[0m ThreadId(02) taskkill returned non-zero status for PID 4836: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ‰®™ÔøΩÔøΩ‡Æ¨ 4836.
[PROCMAN] ÔøΩÔøΩÁ®≠ÔøΩ: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ‡¢†ÔøΩ ‚Æ´Ï™Æ ÔøΩÔøΩ·®´ÔøΩÔøΩ‚¢•ÔøΩÔøΩÔøΩ ( ÔøΩ  ÔøΩÔøΩ‡†¨ÔøΩÔøΩ‡Æ¨ /f ).
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:50:42.182644Z[0m [32m INFO[0m ThreadId(02) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:50:42.182671Z[0m [32m INFO[0m ThreadId(02) Process control stopped successfully: testexe
‚úì Health checks started failing as expected

Step 4: Waiting for restart trigger (after 3 consecutive failures)...
[PROCMAN] [2m2025-11-23T19:50:44.198431Z[0m [32m INFO[0m ThreadId(05) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:44.198513Z[0m [32m INFO[0m ThreadId(05) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:44.214994Z[0m [32m INFO[0m ThreadId(05) Process spawned successfully: testexe (PID: 28828)
[PROCMAN] [2m2025-11-23T19:50:44.215145Z[0m [32m INFO[0m ThreadId(05) Starting health monitor for testexe (type: Http)
[PROCMAN] [2m2025-11-23T19:50:44.215192Z[0m [32m INFO[0m ThreadId(05) HTTP health check endpoint: http://127.0.0.1:18080/
[PROCMAN] [2m2025-11-23T19:50:44.215295Z[0m [32m INFO[0m ThreadId(05) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:44.215324Z[0m [32m INFO[0m ThreadId(05) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:44.215339Z[0m [32m INFO[0m ThreadId(02) Exit monitor started for process testexe (PID: 28828)
[PROCMAN] [2m2025-11-23T19:50:44.215401Z[0m [32m INFO[0m ThreadId(05) Spawning resource monitor task for testexe (PID: 28828)
[PROCMAN] [2m2025-11-23T19:50:44.215494Z[0m [32m INFO[0m ThreadId(05) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:44.215568Z[0m [32m INFO[0m ThreadId(05) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:44.215597Z[0m [32m INFO[0m ThreadId(05) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:44.215669Z[0m [32m INFO[0m ThreadId(02) Health check loop started for testexe (PID: 28828, interval: 3s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:44.215731Z[0m [32m INFO[0m ThreadId(05) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:50:44.215798Z[0m [32m INFO[0m ThreadId(05) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:44.215821Z[0m [32m INFO[0m ThreadId(05) ‚úÖ Automatic restart succeeded for testexe (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:50:44.215845Z[0m [32m INFO[0m ThreadId(05) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:44.215861Z[0m [32m INFO[0m ThreadId(05) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:44.215899Z[0m [32m INFO[0m ThreadId(05) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:44.228678Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 28828)
[PROCMAN] [2m2025-11-23T19:50:44.229954Z[0m [33m WARN[0m ThreadId(06) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:45.960228Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:47.224568Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 28828)
[PROCMAN] [2m2025-11-23T19:50:47.226096Z[0m [33m WARN[0m ThreadId(06) ‚ùå Health check failed for testexe: consecutive failures = 2/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:47.953413Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:49.956556Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:50.220966Z[0m [32m INFO[0m ThreadId(05) üîç Running health check for testexe (PID: 28828)
[PROCMAN] [2m2025-11-23T19:50:50.222264Z[0m [33m WARN[0m ThreadId(09) ‚ùå Health check failed for testexe: consecutive failures = 3/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:50.222313Z[0m [31mERROR[0m ThreadId(09) üö® Health check failure threshold reached for testexe (failures: 3)
[PROCMAN] [2m2025-11-23T19:50:50.222327Z[0m [32m INFO[0m ThreadId(09) üìû Calling restart callback for testexe
[PROCMAN] [2m2025-11-23T19:50:50.222340Z[0m [32m INFO[0m ThreadId(09) üîî Health restart callback invoked for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:50.222354Z[0m [32m INFO[0m ThreadId(09) üîß Restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:50:50.222369Z[0m [32m INFO[0m ThreadId(09) ‚úÖ Health restart allowed, queueing restart request for testexe: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:50.222385Z[0m [32m INFO[0m ThreadId(09) üì¨ Restart request queued successfully for testexe
[PROCMAN] [2m2025-11-23T19:50:50.222397Z[0m [32m INFO[0m ThreadId(09) ‚úÖ Restart callback succeeded for testexe
‚úì Restart triggered after health failure threshold

Step 5: Verifying second instance is running with passing health checks...
[PROCMAN] [2m2025-11-23T19:50:51.960542Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:51.960631Z[0m [32m INFO[0m ThreadId(09) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:50:51.960652Z[0m [32m INFO[0m ThreadId(09) üîÑ Processing restart request for testexe: Unexpected status code: 503 Service Unavailable (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:50:51.960675Z[0m [32m INFO[0m ThreadId(09) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:50:51.960696Z[0m [32m INFO[0m ThreadId(09) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:50:51.960769Z[0m [32m INFO[0m ThreadId(09) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:50:51.961027Z[0m [32m INFO[0m ThreadId(09) Sending termination signal to PID 28828
[PROCMAN] [2m2025-11-23T19:50:52.171229Z[0m [33m WARN[0m ThreadId(09) taskkill returned non-zero status for PID 28828: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ‰®™ÔøΩÔøΩ‡Æ¨ 28828.
[PROCMAN] ÔøΩÔøΩÁ®≠ÔøΩ: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ‡¢†ÔøΩ ‚Æ´Ï™Æ ÔøΩÔøΩ·®´ÔøΩÔøΩ‚¢•ÔøΩÔøΩÔøΩ ( ÔøΩ  ÔøΩÔøΩ‡†¨ÔøΩÔøΩ‡Æ¨ /f ).
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:50:52.171317Z[0m [32m INFO[0m ThreadId(09) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:50:52.171340Z[0m [32m INFO[0m ThreadId(09) Process control stopped successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:54.184854Z[0m [32m INFO[0m ThreadId(02) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:54.184926Z[0m [32m INFO[0m ThreadId(02) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:54.197534Z[0m [32m INFO[0m ThreadId(02) Process spawned successfully: testexe (PID: 11456)
[PROCMAN] [2m2025-11-23T19:50:54.197798Z[0m [32m INFO[0m ThreadId(02) Starting health monitor for testexe (type: Http)
[PROCMAN] [2m2025-11-23T19:50:54.197815Z[0m [32m INFO[0m ThreadId(02) HTTP health check endpoint: http://127.0.0.1:18080/
[PROCMAN] [2m2025-11-23T19:50:54.197906Z[0m [32m INFO[0m ThreadId(02) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:54.197922Z[0m [32m INFO[0m ThreadId(02) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:54.197938Z[0m [32m INFO[0m ThreadId(02) Spawning resource monitor task for testexe (PID: 11456)
[PROCMAN] [2m2025-11-23T19:50:54.197963Z[0m [32m INFO[0m ThreadId(02) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:54.197992Z[0m [32m INFO[0m ThreadId(02) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:54.198010Z[0m [32m INFO[0m ThreadId(02) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:54.198040Z[0m [32m INFO[0m ThreadId(02) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:50:54.198057Z[0m [32m INFO[0m ThreadId(02) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:54.198075Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Automatic restart succeeded for testexe (trigger: HealthFailure)
[PROCMAN] [2m2025-11-23T19:50:54.198070Z[0m [32m INFO[0m ThreadId(06) Health check loop started for testexe (PID: 11456, interval: 3s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:54.198107Z[0m [32m INFO[0m ThreadId(02) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:54.198141Z[0m [32m INFO[0m ThreadId(05) Exit monitor started for process testexe (PID: 11456)
[PROCMAN] [2m2025-11-23T19:50:54.198173Z[0m [32m INFO[0m ThreadId(02) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:50:54.198261Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:54.200434Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 11456)
[PROCMAN] [2m2025-11-23T19:50:54.201615Z[0m [33m WARN[0m ThreadId(09) ‚ùå Health check failed for testexe: consecutive failures = 1/3, reason: Unexpected status code: 503 Service Unavailable
[PROCMAN] [2m2025-11-23T19:50:55.953796Z[0m [32m INFO[0m ThreadId(09) ‚è∞ Heartbeat: Checking for pending restarts for testexe
Process spawn count: 3
‚úì Second instance confirmed (spawn count: 3)

‚ö† No recent successful health checks for new instance
Sending termination signal to PROCMAN...
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: HTTP Health Check Restart
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-http-health-restart\run-1763927433
ok
test test_http_health_timeout ... ignored

test result: ok. 1 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out; finished in 23.23s


running 2 tests
test test_log_collection ... 
========================================
TEST: Log Collection
========================================

=== Test Executor Setup ===
Test: log-collection
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927456
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927456\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927456\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927456
PROCMAN started with PID: Some(3636)
[PROCMAN] [2m2025-11-23T19:50:56.662470Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:50:56.663527Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927456\config.yaml
[PROCMAN] [2m2025-11-23T19:50:56.667419Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:50:56.667504Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:50:57.152546Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:50:57.152643Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:50:57.154450Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 4836)
[PROCMAN] [2m2025-11-23T19:50:57.156421Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:50:57.156464Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:50:57.156497Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:50:57.156531Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:50:57.156559Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:50:57.173262Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:50:57.173426Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:50:57.173543Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:50:57.173578Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:57.173555Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:50:57.173607Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:50:57.173614Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 4068, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:50:57.173690Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:50:57.173755Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:50:57.173783Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:57.174585Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:50:57.174638Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:57.174677Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:50:57.174695Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:50:57.180411Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:50:57.180443Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:57.180727Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
PROCMAN is ready
Step 1: Waiting for TESTEXE to start...
Process 'testexe' is running
‚úì TESTEXE started

Step 2: Waiting for process to produce logs...
[PROCMAN] [2m2025-11-23T19:50:58.188410Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:50:58.188615Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:50:59.181660Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:50:59.181639Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:50:59.181789Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:00.175805Z[0m [32m INFO[0m ThreadId(06) üîç Running health check for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:51:00.175971Z[0m [32m INFO[0m ThreadId(06) üíì Process health check result for testexe: healthy=true, error=None
‚úì TESTEXE producing output

Step 3: Checking for log files...
‚Ñπ Log directory not created: target/tmp/e2e-test-log-collection\logs
  (This is expected as log collection integration is pending)

Step 4: Graceful shutdown...
Sending termination signal to PROCMAN...
[PROCMAN] [2m2025-11-23T19:51:01.182466Z[0m [32m INFO[0m ThreadId(06) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:01.182471Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:51:01.182690Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:02.180305Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:51:02.180445Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST PASSED: Log Collection
========================================

Note: Full log collection integration pending.
This test validates the framework is ready.
Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-log-collection\run-1763927456
ok
test test_log_rotation ... ignored

test result: ok. 1 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out; finished in 6.13s


running 3 tests
test test_cpu_limit_warning ... ignored
test test_memory_growth_violation ... ignored
test test_memory_limit_violation ... 
========================================
TEST: Memory Limit Violation
========================================

=== Test Executor Setup ===
Test: memory-limit
Test dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927462
PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
TESTEXE: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\testexe.exe
===========================

Created test config at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927462\config.yaml
Starting PROCMAN: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\hsu-process-manager.exe
Config: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927462\config.yaml
Working dir: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927462
PROCMAN started with PID: Some(11020)
[PROCMAN] [2m2025-11-23T19:51:02.942426Z[0m [32m INFO[0m ThreadId(01) Starting HSU Process Manager (Rust implementation)
[PROCMAN] [2m2025-11-23T19:51:02.943726Z[0m [32m INFO[0m ThreadId(01) Config file: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927462\config.yaml
[PROCMAN] [2m2025-11-23T19:51:02.947839Z[0m [32m INFO[0m ThreadId(01) Loaded configuration for 1 processes
[PROCMAN] [2m2025-11-23T19:51:02.947929Z[0m [32m INFO[0m ThreadId(01) Creating process manager with 1 processes
[PROCMAN] [2m2025-11-23T19:51:03.487192Z[0m [32m INFO[0m ThreadId(01) Initialized process: testexe
[PROCMAN] [2m2025-11-23T19:51:03.487335Z[0m [32m INFO[0m ThreadId(01) Scanning for existing processes to reattach
[PROCMAN] [2m2025-11-23T19:51:03.492497Z[0m [32m INFO[0m ThreadId(01) Found existing process: testexe (PID: 4068)
[PROCMAN] [2m2025-11-23T19:51:03.493807Z[0m [32m INFO[0m ThreadId(01) Reattachment scan complete: 1 reattached, 0 cleaned up
[PROCMAN] [2m2025-11-23T19:51:03.494010Z[0m [32m INFO[0m ThreadId(01) Starting process manager
[PROCMAN] [2m2025-11-23T19:51:03.494089Z[0m [32m INFO[0m ThreadId(01) Starting process: testexe
[PROCMAN] [2m2025-11-23T19:51:03.494165Z[0m [32m INFO[0m ThreadId(01) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:51:03.494265Z[0m [32m INFO[0m ThreadId(01) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:51:03.512805Z[0m [32m INFO[0m ThreadId(01) Process spawned successfully: testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:03.512971Z[0m [32m INFO[0m ThreadId(01) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:51:03.513076Z[0m [32m INFO[0m ThreadId(01) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:51:03.513099Z[0m [32m INFO[0m ThreadId(01) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:51:03.513120Z[0m [32m INFO[0m ThreadId(01) Spawning resource monitor task for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:03.513148Z[0m [32m INFO[0m ThreadId(01) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:51:03.513115Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:03.513189Z[0m [32m INFO[0m ThreadId(01) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:51:03.513163Z[0m [32m INFO[0m ThreadId(08) Health check loop started for testexe (PID: 28740, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:51:03.513218Z[0m [32m INFO[0m ThreadId(01) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:51:03.513994Z[0m [32m INFO[0m ThreadId(01) Process started successfully: testexe
[PROCMAN] [2m2025-11-23T19:51:03.514044Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:51:03.514080Z[0m [32m INFO[0m ThreadId(01) Heartbeat task spawned for automatic restart processing
[PROCMAN] [2m2025-11-23T19:51:03.514098Z[0m [32m INFO[0m ThreadId(01) Process manager started successfully
[PROCMAN] [2m2025-11-23T19:51:03.525946Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:03.526227Z[0m [32m INFO[0m ThreadId(09) üíæ Memory limit configured for testexe: 100 MB (policy: Restart)
[PROCMAN] [2m2025-11-23T19:51:03.526463Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:03.526643Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
PROCMAN is ready
Step 1: Waiting for TESTEXE to start...
Process 'testexe' is running
‚úì TESTEXE started

Step 2: Waiting for memory allocation (150MB)...
[PROCMAN] [2m2025-11-23T19:51:04.516236Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:04.516359Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:05.530662Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:05.530672Z[0m [32m INFO[0m ThreadId(05) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:05.530828Z[0m [32m INFO[0m ThreadId(05) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:06.528198Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:06.528415Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
‚úì Memory allocation logged

Step 3: Checking for resource monitoring...
[PROCMAN] [2m2025-11-23T19:51:07.523072Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:07.523072Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:07.523419Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:08.516379Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:08.516529Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:09.529361Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:09.529466Z[0m [32m INFO[0m ThreadId(05) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:09.529570Z[0m [32m INFO[0m ThreadId(05) üíì Process health check result for testexe: healthy=true, error=None
‚úì Resource monitoring is active

Step 4: Checking for memory violation detection...
[PROCMAN] [2m2025-11-23T19:51:10.517904Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:10.518036Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:11.525077Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:11.525077Z[0m [32m INFO[0m ThreadId(05) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:11.525624Z[0m [32m INFO[0m ThreadId(05) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:12.520386Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:12.520655Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
‚úì Memory violation detected in logs

Step 5: Waiting for heartbeat to process violation...
[PROCMAN] [2m2025-11-23T19:51:13.515608Z[0m [32m INFO[0m ThreadId(08) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:13.515700Z[0m [32m INFO[0m ThreadId(09) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:13.515814Z[0m [32m INFO[0m ThreadId(02) üíæ Memory limit configured for testexe: 100 MB (policy: Restart)
[PROCMAN] [2m2025-11-23T19:51:13.515841Z[0m [32m INFO[0m ThreadId(09) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:13.515875Z[0m [33m WARN[0m ThreadId(02) ‚ö†Ô∏è  Detected 1 resource violation(s) for testexe
[PROCMAN] [2m2025-11-23T19:51:13.515906Z[0m [32m INFO[0m ThreadId(02) üì§ Sending violation to handler: Memory ‚Üí policy=Restart
[PROCMAN] [2m2025-11-23T19:51:13.515947Z[0m [33m WARN[0m ThreadId(02) üö® Resource violation detected for process testexe: Memory usage 157 MB exceeds limit 100 MB (policy: Restart)
[PROCMAN] [2m2025-11-23T19:51:13.515972Z[0m [31mERROR[0m ThreadId(02) üîÑ RESTART: Resource limit exceeded, triggering automatic restart (policy: restart): Memory usage 157 MB exceeds limit 100 MB
[PROCMAN] [2m2025-11-23T19:51:13.515989Z[0m [32m INFO[0m ThreadId(02) üîß Resource violation restart policy check for testexe: should_restart=true, circuit_breaker_tripped=false
[PROCMAN] [2m2025-11-23T19:51:13.516008Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Resource violation restart allowed, queueing restart request for testexe
[PROCMAN] [2m2025-11-23T19:51:13.516026Z[0m [32m INFO[0m ThreadId(02) üì¨ Resource violation restart request queued for testexe
[PROCMAN] [2m2025-11-23T19:51:14.523949Z[0m [32m INFO[0m ThreadId(05) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:14.524346Z[0m [32m INFO[0m ThreadId(05) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:15.516585Z[0m [32m INFO[0m ThreadId(05) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:15.516691Z[0m [32m INFO[0m ThreadId(05) üì¶ Found pending restart request for testexe
[PROCMAN] [2m2025-11-23T19:51:15.516714Z[0m [32m INFO[0m ThreadId(05) üîÑ Processing restart request for testexe: Resource violation: Memory usage 157 MB exceeds limit 100 MB (trigger: ResourceViolation)
[PROCMAN] [2m2025-11-23T19:51:15.516829Z[0m [32m INFO[0m ThreadId(05) Restarting process control: testexe (force: false)
[PROCMAN] [2m2025-11-23T19:51:15.516624Z[0m [32m INFO[0m ThreadId(08) üîç Running health check for testexe (PID: 28740)
[PROCMAN] [2m2025-11-23T19:51:15.516604Z[0m [32m INFO[0m ThreadId(09) Restart request(s) pending for testexe - will be processed on next heartbeat
[PROCMAN] [2m2025-11-23T19:51:15.516861Z[0m [32m INFO[0m ThreadId(05) Stopping process control: testexe
[PROCMAN] [2m2025-11-23T19:51:15.516938Z[0m [32m INFO[0m ThreadId(08) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:15.517178Z[0m [32m INFO[0m ThreadId(05) Terminating process: testexe
[PROCMAN] [2m2025-11-23T19:51:15.517211Z[0m [32m INFO[0m ThreadId(05) Sending termination signal to PID 28740
‚úì Restart request queued

Step 6: Waiting for automatic restart to complete...
[PROCMAN] [2m2025-11-23T19:51:15.734786Z[0m [33m WARN[0m ThreadId(05) taskkill returned non-zero status for PID 28740: ÔøΩË®°ÔøΩÔøΩ: ÔøΩÔøΩ „§†ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ‰®™ÔøΩÔøΩ‡Æ¨ 28740.
[PROCMAN] ÔøΩÔøΩÁ®≠ÔøΩ: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ‡¢†ÔøΩ ‚Æ´Ï™Æ ÔøΩÔøΩ·®´ÔøΩÔøΩ‚¢•ÔøΩÔøΩÔøΩ ( ÔøΩ  ÔøΩÔøΩ‡†¨ÔøΩÔøΩ‡Æ¨ /f ).
[PROCMAN] 
[PROCMAN] [2m2025-11-23T19:51:15.734877Z[0m [32m INFO[0m ThreadId(05) Process terminated: testexe
[PROCMAN] [2m2025-11-23T19:51:15.734902Z[0m [32m INFO[0m ThreadId(05) Process control stopped successfully: testexe
[PROCMAN] [2m2025-11-23T19:51:17.739640Z[0m [32m INFO[0m ThreadId(02) Starting process control: testexe
[PROCMAN] [2m2025-11-23T19:51:17.739756Z[0m [32m INFO[0m ThreadId(02) Spawning process: testexe
[PROCMAN] [2m2025-11-23T19:51:17.755689Z[0m [32m INFO[0m ThreadId(02) Process spawned successfully: testexe (PID: 12120)
[PROCMAN] [2m2025-11-23T19:51:17.755816Z[0m [32m INFO[0m ThreadId(02) Starting health monitor for testexe (type: Process)
[PROCMAN] [2m2025-11-23T19:51:17.755957Z[0m [32m INFO[0m ThreadId(02) Health monitor started for testexe
[PROCMAN] [2m2025-11-23T19:51:17.756002Z[0m [32m INFO[0m ThreadId(02) Health check task spawned for testexe
[PROCMAN] [2m2025-11-23T19:51:17.756027Z[0m [32m INFO[0m ThreadId(09) Exit monitor started for process testexe (PID: 12120)
[PROCMAN] [2m2025-11-23T19:51:17.756045Z[0m [32m INFO[0m ThreadId(02) Spawning resource monitor task for testexe (PID: 12120)
[PROCMAN] [2m2025-11-23T19:51:17.756120Z[0m [32m INFO[0m ThreadId(02) Spawning violation handler task for testexe
[PROCMAN] [2m2025-11-23T19:51:17.756205Z[0m [32m INFO[0m ThreadId(02) Restart handler monitoring task spawned for testexe
[PROCMAN] [2m2025-11-23T19:51:17.756243Z[0m [32m INFO[0m ThreadId(09) Health check loop started for testexe (PID: 12120, interval: 1s, failure_threshold: 3)
[PROCMAN] [2m2025-11-23T19:51:17.756267Z[0m [32m INFO[0m ThreadId(02) Process control started successfully: testexe
[PROCMAN] [2m2025-11-23T19:51:17.756388Z[0m [32m INFO[0m ThreadId(02) Circuit breaker reset
[PROCMAN] [2m2025-11-23T19:51:17.756417Z[0m [32m INFO[0m ThreadId(02) Process control restarted successfully: testexe
[PROCMAN] [2m2025-11-23T19:51:17.756443Z[0m [32m INFO[0m ThreadId(02) ‚úÖ Automatic restart succeeded for testexe (trigger: ResourceViolation)
[PROCMAN] [2m2025-11-23T19:51:17.756478Z[0m [32m INFO[0m ThreadId(02) Processed 1 restart request(s) for testexe
[PROCMAN] [2m2025-11-23T19:51:17.756503Z[0m [32m INFO[0m ThreadId(02) üîÑ Processed 1 automatic restart(s) for testexe
[PROCMAN] [2m2025-11-23T19:51:17.756555Z[0m [32m INFO[0m ThreadId(02) ‚è∞ Heartbeat: Checking for pending restarts for testexe
[PROCMAN] [2m2025-11-23T19:51:17.768978Z[0m [32m INFO[0m ThreadId(02) üîç Running health check for testexe (PID: 12120)
[PROCMAN] [2m2025-11-23T19:51:17.769095Z[0m [32m INFO[0m ThreadId(02) üíì Process health check result for testexe: healthy=true, error=None
[PROCMAN] [2m2025-11-23T19:51:17.769185Z[0m [32m INFO[0m ThreadId(05) üíæ Memory limit configured for testexe: 100 MB (policy: Restart)
Process spawn count: 2
‚úì Process restarted after memory violation


üìä Test Summary:
  - Process started: ‚úì
  - Memory allocated: ‚úì
  - Resource monitoring: ‚úì
  - Violation detected: ‚úì
  - Restart queued: ‚úì
  - Process restarted: ‚úì
Sending termination signal to PROCMAN...
PROCMAN exited with status: exit code: 1

========================================
‚úì TEST COMPLETED: Memory Limit Violation
(Check summary above for feature status)
========================================

Test artifacts preserved at: C:\Projects\core-tools\current\hsu-procman-rust\target\debug\tmp\e2e-test-memory-limit\run-1763927462
ok

test result: ok. 1 passed; 0 failed; 2 ignored; 0 measured; 0 filtered out; finished in 16.14s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

